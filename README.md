# YouTube AI Moderator

YouTubeのコメントを自動的に検出・フィルタリングするブラウザ拡張機能とLPサイトのモノレポです。

## 機能

### 検出カテゴリ（v5 厳格モード）

#### 通常コメント + ライブチャット共通
- **直接攻撃** (harassment): 侮辱語 + 対象指示/命令を検出
- **露骨ネタバレ** (spoiler): 核心的なネタバレ + 具体性を検出
- **勧誘・連絡誘導** (recruiting): CTA + 連絡先/短縮URLを検出
- **連投スパム** (repeat): 同一内容の繰り返し投稿を検出
- **なりすまし** (impersonation): 公式を騙る + 連絡誘導を検出
- **絵文字壁・ノイズ** (noise): 絵文字や記号の極端な壁を検出
- **匂わせ** (nioase): 情報リーク + 時系列語を検出

#### ライブチャット専用
- **ライブ匂わせ** (hint): 直接示唆・伏せ字による情報リークを検出
- **ライブ語気強** (strongTone): 強い命令・記号壁による攻撃的表現を検出

### 主要機能
- **1ヒット即ブロック**の厳格モード
- **完全ローカル処理**（外部通信なし）
- **難読化対策**強化（Unicode正規化、骨格抽出）
- **草/w/ｗ除外**（単独の笑いは通す）
- **ライブチャット対応**（iframe内のチャット監視）
- 表示モード切り替え（非表示/ぼかし）
- NGキーワード/NGユーザー設定
- 設定のインポート/エクスポート
- SPA遷移対応（ページ遷移時の自動リセット）

## プロジェクト構成

```
youtube-ai-moderator/
├── apps/
│   ├── extension/     # Chrome拡張機能
│   └── site/         # Next.js LPサイト
├── packages/         # 共有パッケージ（将来的な拡張用）
└── .github/         # GitHub Actions CI/CD
```

## セットアップ

### 必要環境
- Node.js 18以上
- Bun 1.0以上

### インストール

```bash
# 依存関係のインストール
bun install

# 開発サーバー起動（拡張機能とサイト両方）
bun dev

# 拡張機能のみ開発
bun run --filter @youtube-ai-moderator/extension dev

# サイトのみ開発
bun run --filter @youtube-ai-moderator/site dev
```

## ビルド

```bash
# 全体ビルド
bun build

# 拡張機能のビルド
bun run --filter @youtube-ai-moderator/extension build

# サイトのビルド
bun run --filter @youtube-ai-moderator/site build

# 拡張機能のZip作成
cd apps/extension && bun zip
```

## 拡張機能の読み込み（開発版）

1. Chrome/Edgeで `chrome://extensions/` を開く
2. 「デベロッパーモード」を有効化
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `apps/extension/dist` フォルダを選択

## v5 厳格モードの確認用サンプル

以下のコメントで動作確認可能（1ヒット即ブロック）：

### 直接攻撃 (Harassment)
- 「**お前消えろ**」
- 「配信者**頭おかしい**、**二度と来るな**」
- 「**てめえ**は**ゴミ**、**謝れ**」

### 露骨ネタバレ (Spoiler)
- 「**犯人は○○**」
- 「**第10話**で○○が**死亡**」
- 「He **dies** in the finale」

### 勧誘・連絡誘導 (Recruiting)
- 「**登録**は **lin.ee** から。**DM**ください」
- 「**Discord**で**連絡** → **discord.gg/**…」
- 「**bit.ly** + **t.me**」（複数URL）

### 連投スパム (Repeat)
- 同一内容を2回以上投稿
- 「**このコメントをコピペして拡散して！**」

### なりすまし (Impersonation)
- 「**【運営】サポートはLINEで**」

### 絵文字壁・ノイズ (Noise)
- 絵文字×7個以上
- 「！！！！！！！！！！」（10個以上）

### 匂わせ (Nioase)
- 「**く、くる**。**次回**○○が**確定**」
- 「**某キャラ**（○○）が黒幕**らしい**」

### ライブ匂わせ (Hint) - ライブチャット専用
- 「**くるぞ**」「**確定**情報です」
- 「**情報筋**によると**来週**○○」
- 「**某**チャンネルで**イニシャル**K」
- 「**◯◯**が**次回**登場**確実**」

### ライブ語気強 (Strong Tone) - ライブチャット専用
- 「**やれ**」「**黙れ**」「**謝れ**」
- 「**！！！！！！**」（記号壁6個以上）
- 「**ーーーーーーーーーーーー**」（長音壁12個以上）
- 絵文字壁×7個以上または80%以上

### 除外例（通す）
- 「**草**」「**www**」「**ｗｗｗ**」（単独）
- 公式情報の引用（CTAなし）

## 品質チェック

```bash
# Lint実行
bun lint

# 型チェック
bun typecheck

# フォーマット
bun format
```

## プライバシーとセキュリティ

- **完全ローカル処理**: 全ての検出処理はブラウザ内で完結
- **外部通信なし**: データの外部送信は一切行いません
- **最小権限**: 必要最小限の権限のみ要求

### 使用権限
- `storage`: 設定の保存
- `activeTab`: アクティブタブでの動作
- `host_permissions`: YouTube.com（通常コメント + ライブチャット）でのコンテンツ読み取り

## 制限事項

- 検出はローカル処理のため、閲覧者の環境でのみ動作
- **厳格モード**のため、安心最優先で疑わしきは隠す
- YouTubeの仕様変更により動作しなくなる可能性があります
- 通常の感想や建設的批評は極力通しますが、誤ブロックの可能性あり

## ライセンス

MIT License

## サポート

問題や提案がある場合は、GitHubのIssueでお知らせください。

## 免責事項

本拡張機能は「現状有姿」で提供されます。誤検知や見逃しによる損害について、開発者は責任を負いません。